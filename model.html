<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Disaster Identification</title>
</head>
<body>
  <h1>Disaster Identification</h1>
  <input type="file" accept="image/*" onchange="processImage(event)">
  <img id="inputImage" style="max-width: 400px;">
  <p id="result">Result: </p>

  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <script>
    async function loadModel() {
      const model = await tf.loadLayersModel('http://localhost:8000/model.json');
      return model;
    }

    async function processImage(event) {
      const file = event.target.files[0];
      const reader = new FileReader();

      reader.onload = async function () {
        const image = new Image();
        image.src = reader.result;
        image.onload = async function () {
          const model = await loadModel();
          const predictions = await predict(model, image);

          const resultElement = document.getElementById('result');
          resultElement.textContent = 'Result: ' + predictions;
        };
      };

      reader.readAsDataURL(file);
    }

    async function predict(model, image) {
      const tensor = tf.browser.fromPixels(image)
        .resizeBilinear([224, 224])
        .toFloat()
        .expandDims();

      const predictions = await model.predict(tensor).data();
      const topPrediction = getTopPrediction(predictions);
      return topPrediction;
    }

    function getTopPrediction(predictions) {
      const maxIndex = predictions.indexOf(Math.max(...predictions));
      return maxIndex;
    }
  </script>
</body>
</html>
